<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>JS Playground</title>

  <style>
    :root {
      --bg: #020617;
      --panel: #020617;
      --text: #e5e7eb;
      --editor: #020617;
      --code: #22c55e;
      --accent: #2563eb;
    }

    body.light {
      --bg: #f8fafc;
      --panel: #ffffff;
      --text: #0f172a;
      --editor: #f1f5f9;
      --code: #0f172a;
      --accent: #2563eb;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      min-height: 100vh;
      background: var(--bg);
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: monospace;
      color: var(--text);
      padding: 16px;
    }

    .app {
      width: 100%;
      max-width: 900px;
      background: var(--panel);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 25px 50px rgba(0,0,0,0.6);
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    h1 {
      font-size: 20px;
      color: var(--accent);
    }

    header button {
      padding: 6px 10px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      background: var(--accent);
      color: white;
    }

    .tabs {
      display: flex;
      gap: 6px;
      margin-bottom: 6px;
    }

    .tab {
      padding: 6px 10px;
      border-radius: 6px;
      cursor: pointer;
      background: #334155;
      color: white;
      font-size: 14px;
    }

    .tab.active {
      background: var(--accent);
    }

    .editor-wrapper {
      display: flex;
      border: 1px solid #334155;
      border-radius: 10px;
      overflow: hidden;
    }

    /* ===== LINE NUMBERS ===== */
    .lines {
      padding: 12px 6px;
      text-align: right;
      color: #64748b;
      user-select: none;
      font-size: 15px;
      line-height: 1.6;
      overflow: hidden;
      align-self: flex-start;
    }

    .lines div {
      height: calc(1.6em);
    }

    /* ===== EDITOR ===== */
    textarea {
      flex: 1;
      height: 260px;
      background: var(--editor);
      color: var(--code);
      border: none;
      padding: 12px;
      font-size: 15px;
      line-height: 1.6;
      resize: none;
      outline: none;
      font-family: monospace;
      overflow-y: auto;
    }

    .buttons {
      display: flex;
      gap: 8px;
      margin: 12px 0;
    }

    .buttons button {
      flex: 1;
      padding: 12px;
      font-size: 16px;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }

    .console {
      background: black;
      padding: 12px;
      border-radius: 10px;
      height: 220px;
      overflow-y: auto;
      font-size: 14px;
    }

    .log { color: var(--text); }
    .error { color: #ef4444; }
  </style>
</head>

<body>
<div class="app">

  <header>
    <h1>JS Playground</h1>
    <button onclick="toggleTheme()">üåô / ‚òÄÔ∏è</button>
  </header>

  <div class="tabs">
    <div class="tab active" onclick="switchFile(0)">main.js</div>
    <div class="tab" onclick="switchFile(1)">test.js</div>
  </div>

  <div class="editor-wrapper">
    <div id="lines" class="lines"></div>
    <textarea id="editor"></textarea>
  </div>

  <div class="buttons">
    <button onclick="runCode()">‚ñ∂ Run</button>
    <button onclick="clearConsole()">üßπ Clear</button>
    <button onclick="download()">‚¨á Export</button>
  </div>

  <div id="console" class="console"></div>

</div>

<script>
  const editor = document.getElementById("editor");
  const consoleBox = document.getElementById("console");
  const lines = document.getElementById("lines");
  const tabs = document.querySelectorAll(".tab");

  let files = [
    localStorage.getItem("file0") || "let x = 10;\nlet y = 5;\nconsole.log(x + y);",
    localStorage.getItem("file1") || "console.log('Hello from test.js');"
  ];

  let current = 0;

  function updateLines() {
    const count = editor.value.split("\n").length;
    lines.innerHTML = "";

    for (let i = 1; i <= count; i++) {
      const div = document.createElement("div");
      div.textContent = i;
      lines.appendChild(div);
    }

    /* clamp line numbers to content height */
    lines.style.height = editor.scrollHeight + "px";
  }

  function switchFile(i) {
    files[current] = editor.value;
    localStorage.setItem("file" + current, files[current]);
    current = i;
    editor.value = files[i];
    tabs.forEach(t => t.classList.remove("active"));
    tabs[i].classList.add("active");
    updateLines();
  }

  editor.value = files[0];
  updateLines();

  editor.addEventListener("input", () => {
    updateLines();
    localStorage.setItem("file" + current, editor.value);
  });

  editor.addEventListener("scroll", () => {
    lines.scrollTop = editor.scrollTop;
  });

  const originalLog = console.log;
  console.log = (...args) => {
    originalLog(...args);
    consoleBox.innerHTML += `<div class="log">&gt; ${args.join(" ")}</div>`;
  };

  function clearConsole() {
    consoleBox.innerHTML = "";
  }

  function runCode() {
    clearConsole();
    try {
      const result = eval(editor.value);
      if (result !== undefined) {
        consoleBox.innerHTML += `<div class="log">&gt; ${result}</div>`;
      }
    } catch (e) {
      consoleBox.innerHTML += `<div class="error">Error: ${e.message}</div>`;
    }
  }

  document.addEventListener("keydown", e => {
    if ((e.ctrlKey || e.metaKey) && e.key === "Enter") {
      runCode();
    }
  });

  function toggleTheme() {
    document.body.classList.toggle("light");
  }

  function download() {
    const blob = new Blob([editor.value], { type: "text/javascript" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = tabs[current].innerText;
    a.click();
  }
</script>
</body>
</html>
