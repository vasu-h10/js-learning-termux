<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Playground v13.1 ‚Äî JSX + TSX + React</title>

<!-- REACT & REACT DOM FOR JSX/TSX -->
<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

<!-- BABEL FOR JSX/TSX TRANSFORM -->
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<style>
:root {
  --bg:#020617; --panel:#020617; --text:#e5e7eb;
  --editor:#0f172a; --accent:#2563eb; --console-bg:#000;
}

body {
  margin:0; background:var(--bg); color:var(--text);
  font-family:monospace; display:flex; justify-content:center;
  padding:10px; min-height:100vh;
}

.app {
  width:100%; max-width:900px; background:var(--panel);
  padding:12px; border-radius:12px;
}

.file-tabs {
  display:flex; gap:6px; margin:8px 0; overflow-x:auto;
}

.file-btn {
  padding:8px 12px; background:#334155; border-radius:8px;
  color:white; cursor:pointer; flex-shrink:0;
}

.file-btn.active { background:var(--accent); }

textarea {
  width:100%; height:300px; background:var(--editor); color:#22c55e;
  border-radius:10px; border:none; padding:12px; font-size:16px; resize:none;
}

.buttons {
  display:flex; gap:8px; margin-top:10px; flex-wrap:wrap;
}
button {
  flex:1; padding:12px; border-radius:10px;
  border:none; background:var(--accent); color:white;
  cursor:pointer; font-size:16px;
}

.console {
  background:var(--console-bg); height:200px;
  border-radius:10px; padding:12px; overflow-y:auto;
  margin-top:12px; font-size:14px;
}
.error { color:red; }
.log { color:white; }

/* FULLSCREEN CONSOLE */
#consoleFull {
  display:none; position:fixed; top:0; left:0;
  width:100vw; height:100vh; background:black; padding:12px;
  overflow-y:auto; z-index:9999;
}
#consoleFullContent { white-space:pre-wrap; }

/* FULLSCREEN PREVIEW */
#previewArea {
  display:none; position:fixed; top:0; left:0;
  width:100vw; height:100vh; background:white; z-index:9999;
}
#previewFrame {
  width:100vw; height:calc(100vh - 55px);
  border:none; background:white;
}

/* MOBILE */
@media(max-width:600px){
  textarea { height:350px; font-size:16px; }
  button { font-size:15px; padding:10px; }
}
</style>
</head>

<body>
<div class="app" id="editorArea">
  <h2>Playground v13.1 ‚Äî React + JSX + TSX</h2>

  <!-- FILE SWITCHER -->
  <div class="file-tabs">
    <div class="file-btn active" onclick="switchFile('html')">index.html</div>
    <div class="file-btn" onclick="switchFile('css')">style.css</div>
    <div class="file-btn" onclick="switchFile('js')">script.js</div>
    <div class="file-btn" onclick="switchFile('jsx')">app.jsx</div>
    <div class="file-btn" onclick="switchFile('tsx')">app.tsx</div>
  </div>

  <textarea id="editor"></textarea>

  <div class="buttons">
    <button onclick="runCode()">‚ñ∂ Run</button>
    <button onclick="showConsole()">üí¨ Console bottom</button>
    <button onclick="showPreview()">üåç Preview</button>
    <button onclick="showConsoleFull()">üñ• Full Console</button>
    <button onclick="showPreviewFull()">üåê Full Preview</button>
    <button onclick="clearConsole()">üßπ Clear</button>
  </div>

  <div id="console" class="console"></div>
</div>

<!-- FULL PREVIEW -->
<div id="previewArea">
  <button onclick="hidePreview()">üîô Back</button>
  <iframe id="previewFrame"></iframe>
</div>

<!-- FULL CONSOLE -->
<div id="consoleFull">
  <button onclick="hideConsoleFull()">üîô Back</button>
  <pre id="consoleFullContent"></pre>
</div>

<script>
/* ===== FILE STORAGE ===== */
let files = {
  html: localStorage.getItem("html") || "<h1>Hello Android!</h1><div id='root'></div>",
  css : localStorage.getItem("css")  || "h1{color:green;}",
  js  : localStorage.getItem("js")   || "console.log('JS Works!');",
  jsx : localStorage.getItem("jsx")  || "function App(){return <h2>Hello JSX!</h2>} App();",
  tsx : localStorage.getItem("tsx")  || "function App():any{return <h2>Hello TSX!</h2>} App();",
};

let selectedExt="html";
const editor=document.getElementById("editor");
const consoleBox=document.getElementById("console");

/* ===== SWITCH FILE ===== */
function switchFile(ext){
  files[selectedExt]=editor.value;
  selectedExt=ext;
  editor.value=files[ext];
  document.querySelectorAll(".file-btn").forEach(b=>b.classList.remove("active"));
  document.querySelectorAll(".file-btn").forEach(btn=>{
    if(btn.innerText.includes(ext)) btn.classList.add("active");
  });
}
editor.addEventListener("input",()=>{
  files[selectedExt]=editor.value;
  localStorage.setItem(selectedExt,editor.value);
});

/* ===== CONSOLE ===== */
function clearConsole(){ consoleBox.innerHTML=""; }
function logConsole(m){ consoleBox.innerHTML+=`<div class="log">${m}</div>`; }
function showConsole(){ window.scrollTo(0,document.body.scrollHeight); }

/* FULL console */
function showConsoleFull(){
  consoleFull.style.display="block";
  consoleFullContent.innerText = consoleBox.innerText;
}
function hideConsoleFull(){ consoleFull.style.display="none"; }

/* ===== RUN CODE ===== */
function runCode(){
  clearConsole();
  let code = files["js"];

  if(selectedExt==="jsx"||selectedExt==="tsx"){
    try{
      code = Babel.transform(files[selectedExt],{
        presets:["react","typescript"],
        filename: selectedExt==="tsx"?"file.tsx":"file.jsx"
      }).code;
    }catch(e){ return logConsole("TSX/JSX Error: "+e.message); }
  }

  try{
    let result=eval(code);
    if(result!==undefined) logConsole("> "+result);
  }catch(e){ logConsole("JS Error: "+e.message); }
}

/* ===== PREVIEW ===== */
function generatePreview(){
  let html = files["html"];
  let css  = files["css"];
  let jsCode = files["js"];

  if(files["jsx"]){
    try{
      jsCode += "\n"+Babel.transform(files["jsx"],{
        presets:["react"],
        filename:"file.jsx"
      }).code;
    }catch(e){}
  }
  if(files["tsx"]){
    try{
      jsCode += "\n"+Babel.transform(files["tsx"],{
        presets:["react","typescript"],
        filename:"file.tsx"
      }).code;
    }catch(e){}
  }

  return `
    <html>
      <head><style>${css}</style></head>
      <body>${html}
      <script>
        try{ ${jsCode} }
        catch(e){ document.body.innerHTML += '<pre style="color:red">'+e+'</pre>' }
      <\/script>
      </body>
    </html>`;
}

function showPreview(){
  const frame=document.getElementById("previewFrame");
  files[selectedExt]=editor.value;
  frame.srcdoc=generatePreview();
}
function showPreviewFull(){
  files[selectedExt]=editor.value;
  previewArea.style.display="block";
  editorArea.style.display="none";
  previewFrame.srcdoc=generatePreview();
}
function hidePreview(){
  previewArea.style.display="none";
  editorArea.style.display="block";
}

/* INIT */
editor.value=files["html"];
</script>
</body>
</html>
