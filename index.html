<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Playground v6 ‚Äî Android First + JSX + TSX</title>

<!-- JSX + TSX support -->
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<style>
:root {
  --bg: #020617;
  --panel: #020617;
  --text: #e5e7eb;
  --editor: #0f172a;
  --accent: #2563eb;
  --console-bg: #000;
}

body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: monospace;
  display: flex;
  justify-content: center;
  padding: 10px;
  min-height: 100vh;
}

.app {
  width: 100%;
  max-width: 900px;
  background: var(--panel);
  padding: 12px;
  border-radius: 12px;
}

h2 {
  margin-top: 0;
  color: var(--accent);
}

.file-tabs {
  display: flex;
  gap: 6px;
  margin: 8px 0;
  overflow-x: auto;
}

.file-btn {
  padding: 8px 12px;
  background: #334155;
  border-radius: 8px;
  color: white;
  cursor: pointer;
  flex-shrink: 0;
}

.file-btn.active {
  background: var(--accent);
}

textarea {
  width: 100%;
  height: 300px;
  background: var(--editor);
  color: #22c55e;
  border-radius: 10px;
  border: none;
  padding: 12px;
  font-size: 16px;
  resize: none;
}

.buttons {
  display: flex;
  gap: 8px;
  margin-top: 10px;
  flex-wrap: wrap;
}

button {
  flex: 1;
  padding: 12px;
  border-radius: 10px;
  border: none;
  background: var(--accent);
  color: white;
  cursor: pointer;
  font-size: 16px;
}

.console {
  background: var(--console-bg);
  height: 200px;
  border-radius: 10px;
  padding: 12px;
  overflow-y: auto;
  margin-top: 12px;
  font-size: 14px;
}

.log { color: white; }
.error { color: red; }

/* fullscreen console */
#consoleFull {
  display:none;
  position:fixed;
  top:0; left:0;
  width:100vw; height:100vh;
  background:black;
  padding:12px;
  overflow-y:auto;
  z-index:9999;
}

/* fullscreen preview */
#previewArea {
  display:none;
  position:fixed;
  top:0; left:0;
  width:100vw; height:100vh;
  background:white;
  z-index:9999;
}

#previewFrame {
  width:100vw;
  height:calc(100vh - 55px);
  border:none;
  background:white;
}

/* Android screen support */
@media(max-width:600px){
  textarea { height:350px; font-size:16px; }
  button { font-size:15px; padding:10px; }
}
</style>
</head>

<body>

<!-- EDITOR AREA -->
<div class="app" id="editorArea">
  <h2>Playground v6 ‚Äî Android + JSX/TSX</h2>

  <div class="file-tabs">
    <div class="file-btn active" onclick="switchFile('html')">index.html</div>
    <div class="file-btn" onclick="switchFile('css')">style.css</div>
    <div class="file-btn" onclick="switchFile('js')">script.js</div>
    <div class="file-btn" onclick="switchFile('jsx')">app.jsx</div>
    <div class="file-btn" onclick="switchFile('tsx')">app.tsx</div>
  </div>

  <textarea id="editor"></textarea>

  <div class="buttons">
    <button onclick="runCode()">‚ñ∂ Run</button>
    <button onclick="showConsole()">üí¨ Console</button>
    <button onclick="showPreview()">üåç Preview</button>

    <button onclick="showConsoleFull()">üñ• Full Console</button>
    <button onclick="showPreviewFull()">üåê Full Preview</button>

    <button onclick="clearConsole()">üßπ Clear</button>
  </div>

  <div id="console" class="console"></div>
</div>

<!-- FULL SCREEN PREVIEW -->
<div id="previewArea">
  <button onclick="hidePreview()">üîô Back</button>
  <iframe id="previewFrame"></iframe>
</div>

<!-- FULL SCREEN CONSOLE -->
<div id="consoleFull">
  <button onclick="hideConsoleFull()">üîô Back</button>
  <pre id="consoleFullContent"></pre>
</div>

<script>
/* ================== FILES =================== */
let files = {
  html: localStorage.getItem("html") || "<h1>Hello Android!</h1>",
  css: localStorage.getItem("css") || "body { background:white; }",
  js: localStorage.getItem("js") || "console.log('JS Works!');",
  jsx: localStorage.getItem("jsx") || "function App(){ return <h1>Hello JSX!</h1>; }\nApp();",
  tsx: localStorage.getItem("tsx") || "function App():any{ return <h1>Hello TSX!</h1>; }\nApp();",
};

let selectedExt = "html";

const editor = document.getElementById("editor");
const consoleBox = document.getElementById("console");

/* ============ FILE SWITCH ============= */
function switchFile(ext){
  files[selectedExt] = editor.value;
  selectedExt = ext;
  editor.value = files[ext];
  document.querySelectorAll(".file-btn").forEach(b=>b.classList.remove("active"));
  [...document.querySelectorAll(".file-btn")].find(b=>b.innerText.includes(ext)).classList.add("active");
}

editor.addEventListener("input",()=>{
  files[selectedExt] = editor.value;
  localStorage.setItem(selectedExt, editor.value);
});

/* ============ CONSOLE FUNCTIONS ============= */
function clearConsole(){ consoleBox.innerHTML=""; }

function logConsole(msg){
  consoleBox.innerHTML += `<div class="log">${msg}</div>`;
}

/* FULL SCREEN CONSOLE */
function showConsoleFull(){
  document.getElementById("consoleFull").style.display="block";
  document.getElementById("consoleFullContent").innerText = consoleBox.innerText;
}
function hideConsoleFull(){
  document.getElementById("consoleFull").style.display="none";
}

/* SHOW NORMAL CONSOLE */
function showConsole(){
  window.scrollTo(0,document.body.scrollHeight);
}

/* ============ RUN CODE ============= */
function runCode(){
  clearConsole();
  let code = files["js"];

  if (selectedExt==="jsx" || selectedExt==="tsx"){
    try {
      code = Babel.transform(files[selectedExt], { presets:["react","typescript"] }).code;
    } catch(e){
      return logConsole("JSX/TSX Error: " + e.message);
    }
  }

  try {
    let result = eval(code);
    if(result !== undefined) logConsole("> " + result);
  }catch(e){
    logConsole("JS Error: " + e.message);
  }
}

/* ============ PREVIEW GENERATION ============= */
function generatePreview(){
  let html = files["html"] || "";
  let css = files["css"] || "";
  let jsCode = files["js"] || "";

  if (files["jsx"]){
    try { jsCode += "\n" + Babel.transform(files["jsx"],{presets:["react"]}).code; } catch(e){}
  }
  if (files["tsx"]){
    try { jsCode += "\n" + Babel.transform(files["tsx"],{presets:["react","typescript"]}).code; } catch(e){}
  }

  return `
    <!DOCTYPE html>
    <html>
      <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <style> body{font-size:18px;padding:12px;} ${css} </style>
      </head>
      <body>${html}
        <script>
          try { ${jsCode} }
          catch(e){ document.body.innerHTML += '<pre style="color:red">'+e+'</pre>' }
        <\/script>
      </body>
    </html>`;
}

/* ============ PREVIEW ============= */
function showPreview(){
  files[selectedExt] = editor.value;
  const iframe = document.getElementById("previewFrame");
  iframe.srcdoc = generatePreview();
}

function showPreviewFull(){
  document.getElementById("previewArea").style.display="block";
  document.getElementById("editorArea").style.display="none";
  document.getElementById("previewFrame").srcdoc = generatePreview();
}

function hidePreview(){
  document.getElementById("previewArea").style.display="none";
  document.getElementById("editorArea").style.display="block";
}

/* init */
editor.value = files["html"];
</script>
</body>
</html>
